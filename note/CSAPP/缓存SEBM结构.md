# 缓存的 S, E, B, M 结构

缓存的 **S, E, B, M** 结构是描述缓存体系结构的四个关键参数，帮助理解缓存如何组织和管理数据。每个字母代表缓存的不同组成部分：

- **S** — 集合数（Set）
- **E** — 组内行数（Associative degree）
- **B** — 缓存行大小（Block size）
- **M** — 总缓存大小（Total Cache Size）

## 1. **S（Set） - 缓存集合数**
- 缓存被划分为多个“集合”（Set），每个集合包含若干个缓存行。**S**的值决定了缓存的“组相联”结构。
- **S**的大小通常是2的幂，例如 64 个集合、128 个集合等。
- 每个内存块会根据一定的映射规则映射到特定的缓存集合中。

## 2. **E（Associative degree） - 组内行数**
- **E**表示每个缓存集合内的缓存行数，也称为**组相联度**。
- 一个内存块可以映射到一个集合中的**E**个缓存行中的任意一个。
- **E**的值越大，缓存的“组相联度”越高，缓存冲突的概率更低，但硬件实现会变得更加复杂。

## 3. **B（Block size） - 缓存行大小（块大小）**
- **B**表示每个缓存行的大小，通常为64字节或128字节。
- 每个缓存行存储的是从主内存中读取的连续数据块，因此缓存是按块组织的。
  
## 4. **M（Total Cache Size） - 总缓存大小**
- **M**表示缓存的总大小，即缓存中所有缓存行的总字节数。
- 总缓存大小计算公式：  
  \[
  M = S \times E \times B
  \]
  其中，S为集合数，E为每组的缓存行数，B为每个缓存行的大小。

### 示例
假设一个缓存的配置为：S = 128, E = 8, B = 64字节。
那么总缓存大小为：
\[
M = 128 \times 8 \times 64 = 65536 \, \text{字节} = 64 \, \text{KB}
\]
这意味着：
- 缓存有128个集合（S=128）。
- 每个集合包含8个缓存行（E=8）。
- 每个缓存行的大小是64字节（B=64）。

## 总结
- **S（集合数）**：决定缓存中的集合数量。
- **E（组内行数）**：决定每个集合中的缓存行数，也叫做相联度。
- **B（缓存行大小）**：决定每个缓存行的存储大小。
- **M（总缓存大小）**：通过S、E和B的乘积计算出的缓存的总存储容量。

这些参数的组合决定了缓存的结构和性能，尤其是在处理缓存访问时的效率和缓存冲突的频率。
[图解](file:///C:\Users\hemingyang\Pictures\开发文档\20-caching_08.jpg)